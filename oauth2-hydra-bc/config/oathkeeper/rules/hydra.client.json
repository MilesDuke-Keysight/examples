[
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:clients:list",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/clients",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}clients",
    "requiredAction": "${HYDRA_ACTION_PREFIX}get",
    "requiredScopes": [
      "hydra.clients"
    ]
  },



  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:clients:create",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/clients",

    "authenticators": [
      {
        "type": "oauth2_introspection",
        "options": {
          "requiredScopes": []
        }
      },
      {
        "type": "oauth2_client_credentials",
        "options": {
          "requiredScopes": []
        }
      }
    ],
    "authorizers": [

    ],

    "validators": {
      "all": [
        {
          "validator": "keto_warden_oauth2",
          "configuration": {
            "requiredResource": "${HYDRA_RESOURCE_PREFIX}clients",
            "requiredAction": "${HYDRA_ACTION_PREFIX}create",
            "requiredScopes": [
              "hydra.clients"
            ]
          }
        }
      ]
    },
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },



  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:clients:update",
    "matchesMethods": [
      "PUT"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/clients/<.+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}clients:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}update",
    "requiredScopes": [
      "hydra.clients"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:clients:get",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/clients/<.+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}clients:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}get",
    "requiredScopes": [
      "hydra.clients"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:clients:delete",
    "matchesMethods": [
      "DELETE"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/clients/<.+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}clients:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}delete",
    "requiredScopes": [
      "hydra.clients"
    ]
  }
]
