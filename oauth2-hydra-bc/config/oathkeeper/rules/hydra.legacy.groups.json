[
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:list",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups",
    "requiredAction": "${HYDRA_ACTION_PREFIX}list",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }, {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:create",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups",
    "requiredAction": "${HYDRA_ACTION_PREFIX}create",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }, {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:get",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}get",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }, {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:delete",
    "matchesMethods": [
      "DELETE"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}delete",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }, {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:members:add",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups/<[^/]+>/members",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}members.add",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }, {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:roles-legacy:members:remove",
    "matchesMethods": [
      "DELETE"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/warden/groups/<[^/]+>/members",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${KETO_URL}/roles",
      "stripPath": "/warden/groups"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}warden:groups:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}members.remove",
    "requiredScopes": [
      "hydra.warden.groups"
    ]
  }
]
