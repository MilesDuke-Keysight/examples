[
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:well-known",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/.well-known/jwks.json",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:get-key",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>/<.+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1:$2",
    "requiredAction": "${HYDRA_ACTION_PREFIX}get",
    "requiredScopes": [
      "hydra.keys.get"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:get-key-set",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}get",
    "requiredScopes": [
      "hydra.keys.get"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:create-key-set",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}create",
    "requiredScopes": [
      "hydra.keys.create"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:update-key-set",
    "matchesMethods": [
      "PUT"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}update",
    "requiredScopes": [
      "hydra.keys.update"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:update-key",
    "matchesMethods": [
      "PUT"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1:$2",
    "requiredAction": "${HYDRA_ACTION_PREFIX}update",
    "requiredScopes": [
      "hydra.keys.update"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:update-key-set",
    "matchesMethods": [
      "DELETE"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1",
    "requiredAction": "${HYDRA_ACTION_PREFIX}delete",
    "requiredScopes": [
      "hydra.keys.delete"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:keys:update-key",
    "matchesMethods": [
      "DELETE"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/keys/<[^/]+>/<[^/]+>",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${HYDRA_RESOURCE_PREFIX}keys:$1:$2",
    "requiredAction": "${HYDRA_ACTION_PREFIX}delete",
    "requiredScopes": [
      "hydra.keys.delete"
    ]
  }
]
