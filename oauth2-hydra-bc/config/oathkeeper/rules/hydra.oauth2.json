[
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:well-known",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/.well-known/openid-configuration",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:userinfo",
    "matchesMethods": [
      "GET", "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/userinfo",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:revoke",
    "matchesMethods": [
      "GET", "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/revoke",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:token",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/token",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:auth",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/auth",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:consent-fallback",
    "matchesMethods": [
      "GET"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/consent-fallback",
    "mode": "pass_through",
    "upstream": {
      "url": "${HYDRA_URL}/"
    }
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:introspect",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/introspect",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${KETO_RESOURCE_PREFIX}oauth2:tokens",
    "requiredAction": "${KETO_ACTION_PREFIX}introspect",
    "requiredScopes": [
      "hydra.introspect"
    ]
  },
  {
    "id": "${OATHKEEPER_RESOURCE_PREFIX}rules:hydra:oauth2:flush",
    "matchesMethods": [
      "POST"
    ],
    "matchesUrl": "${OATHKEEPER_PROXY_URL}/oauth2/introspect",
    "mode": "keto_warden_oauth2",
    "upstream": {
      "url": "${HYDRA_URL}/"
    },
    "requiredResource": "${KETO_RESOURCE_PREFIX}oauth2:tokens",
    "requiredAction": "${KETO_ACTION_PREFIX}flush",
    "requiredScopes": [
      "hydra.flush-tokens"
    ]
  }
]
